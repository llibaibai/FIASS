Instructions for using MATLAB image processing scripts
========================================

Introduction
----
This repository contains two MATLAB scripts for processing image data in TIF format, extracting grayscale or green channel information of specific areas, and performing data smoothing and normalization. Suitable for scenarios such as cell image analysis.

Script function overview
------------

1. [Sigletrangle_smooth.m]
- Function:
- Read TIF images one by one, and the user interactively selects the center point and then selects a rectangular area of ​​fixed size.
- Calculate the sum and mean of the grayscale values ​​of the area, and perform smoothing and normalization.
- Output:
- Marked image with red frame (saved in the `PICTURE` folder).
- Excel file (`analyze.xlsx`), containing the original data, smoothed data and normalized results.

2. [REGION_smooth.m]
- Function:
- Automatically divide the image into fixed-size sub-regions (e.g. 40x40 pixels).
- Extract the green channel data of each sub-region, smooth it and normalize it (based on the first image).
- Output:
- Marked image with red border (saved in the `region` folder).
- Excel file (`region_analysis.xlsx`) containing the smoothed and normalized values ​​of each region.

Environment requirements
--------
- MATLAB version: R2018b or higher.
- Required toolbox: Image Processing Toolbox.

Usage steps
--------

General preparation
1. Folder structure:
- Put all TIF images to be processed in the same folder.
- Make sure the image file name contains numbers (e.g. `image_001.tif`), the script will process them in numerical order.

2. Modify path parameters:
- Open the script file, find the following line of code, and replace the path with your image folder path:
* Sigletrangle_smooth.m:
folderPath = 'E:\QQQQQ\example'; % Change to your path
* REGION_smooth.m:
folderPath = 'C:\Users\18360\Desktop\example'; % Change to your path

Run Sigletrangle_smooth.m
1. Parameter settings:
- Modify the rectangle side length (default 50 pixels):
squareSize = 50; % Adjust as needed
- Smoothing window size (default 5):
windowSize = 5;

2. Execute the script:
- After running, click the center point of each image in turn, and the script will automatically select the area and save the result.
- Note: MATLAB will pop up an interactive window, and you need to manually click to select the center point.

Run REGION_smooth.m
1. Parameter settings:
- Modify the sub-region size (default 50 pixels):
regionSize = 50;
- Smoothing window size (default 5):
windowSize = 5;

2. Execute the script:
- The script automatically divides the region without manual interaction.
- The output file contains the data for each sub-region.

Output file description
------------

1. Output generated by Sigletrangle_smooth:
- PICTURE folder:
* selected_*.tif: Marked image with red box selection.
- analyze.xlsx: Contains the following columns:
filename | SumGrayValue | MeanGrayValue | NormalizedGrayValue | SmoothedMean | SmoothedNormalized

2. Output generated by REGION_smooth:
- region folder:
* *_marked.tif: subregion marked images with red borders.
- region_analysis.xlsx: Each column corresponds to the smoothed and normalized values ​​of a subregion.

Common Problems
--------
1. Images are not processed in numerical order:
- Make sure that the file name contains consecutive numbers (such as `image_1.tif`, `image_2.tif`), and the script sorts by the first extracted number.

2. Region exceeds the image boundary:
- Check if the image size is larger than the set rectangle or subregion size, and adjust squareSize or regionSize if necessary.

3. Excel file writing failed:
- Close the opened Excel file and ensure that MATLAB has write permission.

4. MATLAB reports an error "function not defined":
- Check whether the Image Processing Toolbox is installed.